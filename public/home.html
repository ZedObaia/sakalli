<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-" />
  <title>index</title>
</head>

<body>
  <h>test websocket</h>
  <p id="message-json"></p>
  <p id="message-text"></p>
  <script>
    window.onload = function () {
      var conn;
      if (window["WebSocket"]) {
        conn = new WebSocket("ws://" + document.location.host + "/ws");

        conn.onclose = function (evt) {
          console.log("connection closed")
        };

        conn.onopen = function (evt) {
          console.log("Connection open ...");
        };

        conn.onmessage = function (evt) {
          console.log("Received Message: " + evt.data);
          document.getElementById("message-json").innerText += evt.data;
        };

        window.onbeforeunload = function () {
          conn.send("closing ...")
          conn.close()
        }
      } else {
        console.log("browser does not support websocket")
      }


    };
  </script>
</body>

</html>